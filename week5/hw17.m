% CHRISTINE SHUE
% DUE: AUGUST 3, 2017
% HW 17: Cubic splines
% /u/erdos/students/cshue1/cisc4750/week5/hw17.m

x = [-1 0 1 2];
y = [4 5 2 1];

A = [-1 1 -1 1 0 0 0 0 0 0 0 0
    0 0 0 1 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 1 0 0 0 0
    0 0 0 0 1 1 1 1 0 0 0 0
    0 0 0 0 0 0 0 0 1 1 1 1
    0 0 0 0 0 0 0 0 8 4 2 1
    0 0 1 0 0 0 -1 0 0 0 0 0
    0 0 0 0 3 2 1 0 -3 -2 -1 0 
    0 2 0 0 0 -2 0 0 0 0 0 0
    0 0 0 0 6 2 0 0 -6 -2 0 0
    -6 2 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 12 2 0 0];
b = [4;5;5;2;2;1;0;0;0;0;0;0];
p = A\b

x1 = -1:0.1:0;
p1 = p(1:4);
s1 = polyval(p1,x1);

x2 = 0:0.1:1;
p2 = p(5:8);
s2 = polyval(p2,x2);

x3 = 1:0.1:2;
p3 = p(9:12);
s3 = polyval(p3,x3);
plot(x,y,'o',x1,s1,'m',x2,s2,'b',x3,s3,'g');



